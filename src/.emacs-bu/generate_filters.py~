#!/usr/bin/env python2
from __future__ import division
import numpy as np

class Filter():
    def __init__(self, orientation, axis, cam_w, cam_h, fovx, fovy,
                 generate=True):
        self.orientation = orientation
        self.axis = axis
        self.cam_w = cam_w
        self.cam_h = cam_h,
        self.fovx = fovx
        self.fovy = fovy
        if generate:
            self.matched_filter = generate_filter
        else:
            self.matched_filter = None
            
    def generate_filter():
        D = self._get_anticipated_viewing_directions()
        sin_theta = np.linalg.norm(D[:, :, 0:2], axis=2) + 1e-14
        mag_temp = np.linalg.norm(D, axis=2)
        D /= np.expand_dims(mag_temp, axis=2)
        return sin_theta.reshape(self.cam.h,
                                 self.cam.w, 1)
